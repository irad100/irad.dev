---
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../consts';
import { getCollection } from 'astro:content';
import FormattedDate from '../components/FormattedDate.astro';
import { Image } from 'astro:assets';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
).slice(0, 3); // Get only the 3 most recent posts
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
	<body>
		<Header />
		<main class="max-w-4xl mx-auto px-4 py-8">
			<section class="py-16 text-center">
				<h1 class="text-5xl font-bold mb-4">Hello, I'm Irad üëãüèª</h1>
				<p class="text-xl text-site-gray max-w-2xl mx-auto">
					In this blog I write about my experiences and thoughts on security, AI, software
					engineering and other topics.
				</p>
			</section>
			<section class="flex flex-col md:flex-row gap-8 mt-8 mb-16">
				<div class="md:w-1/3 flex-shrink-0">
					<Image
						src="/me.jpeg"
						alt="Irad Aharoni"
						width={300}
						height={300}
						class="rounded-lg w-full"
					/>
				</div>
				<div class="flex-1">
					<h2 class="text-3xl font-bold mb-4">About Me</h2>
					<p>
						I'm a software engineer and security researcher, passionate about building stuff,
						learning new things, and sharing knowledge.
					</p>
					<p class="mb-8">
						Currently working as a Senior Software Engineer and Security Researcher
						in the CTO Office at <a href="https://orca.security" class="text-accent hover:text-accent-dark">Orca Security</a>.
					</p>
					<div class="text-center md:text-left">
						<a 
							href="/about" 
							class="inline-block bg-accent text-white px-6 py-3 rounded-lg hover:bg-accent-dark transition-colors"
						>
							Learn More About Me ‚Üí
						</a>
					</div>
				</div>
			</section>

			<section class="my-16">
				<h2 class="text-3xl font-bold mb-8 text-center md:text-left">Recent Posts</h2>
				<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
					{
						posts.map((post) => (
							<a 
								href={`/blog/${post.id}/`} 
								class="block group bg-white border border-gray-light rounded-xl overflow-hidden shadow-sm hover:shadow-lg hover:-translate-y-1 group-hover:border-accent transition-all duration-300 ease-in-out"
							>
								<div class="overflow-hidden">
									<img 
										src={post.data.heroImage} 
										alt="" 
										class="w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300 ease-in-out"
									/>
								</div>
								<div class="p-6">
									<h3 class="text-xl font-semibold mb-2 group-hover:text-accent transition-colors">
										{post.data.title}
									</h3>
									<p class="text-sm text-site-gray mb-3">
										<FormattedDate date={post.data.pubDate} />
									</p>
									<p class="text-sm leading-relaxed">{post.data.description}</p>
								</div>
							</a>
						))
					}
				</div>
				<div class="text-center mt-12">
					<a 
						href="/blog" 
						class="inline-block bg-accent text-white px-6 py-3 rounded-lg hover:bg-accent-dark transition-colors"
					>
						View All Posts ‚Üí
					</a>
				</div>
			</section>
		</main>
		<Footer />
	</body>
</html>
